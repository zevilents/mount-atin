local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local LocalPlayer = Players.LocalPlayer

-- Window
local Window = Rayfield:CreateWindow({
    Name = "Custom Hub Final",
    LoadingTitle = "Rayfield Final Hub",
    LoadingSubtitle = "by ChatGPT",
    Theme = "Default",
    DisableRayfieldPrompts = false,
    DisableBuildWarnings = false,
    ConfigurationSaving = {
        Enabled = true,
        FileName = "FinalHub"
    }
})

-- Tabs
local PlayerTab = Window:CreateTab("Player", 4483362458)
local TeleportTab = Window:CreateTab("Teleport", 4483362458)
local ServerTab = Window:CreateTab("Server", 4483362458)
local TrollTab = Window:CreateTab("Troll", 4483362458)

-------------------------------------------------
-- PLAYER TAB
-------------------------------------------------
-- WalkSpeed
local defaultWalk = 16
PlayerTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 200},
    Increment = 1,
    CurrentValue = 16,
    Suffix = "speed",
    Callback = function(v)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = v
        end
    end,
})
PlayerTab:CreateButton({
    Name = "Reset WalkSpeed",
    Callback = function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = defaultWalk
        end
    end,
})

-- JumpPower
local defaultJump = 50
PlayerTab:CreateSlider({
    Name = "JumpPower",
    Range = {50, 300},
    Increment = 5,
    CurrentValue = 50,
    Suffix = "power",
    Callback = function(v)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.JumpPower = v
        end
    end,
})
PlayerTab:CreateButton({
    Name = "Reset JumpPower",
    Callback = function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.JumpPower = defaultJump
        end
    end,
})

-- Fly
local flyEnabled = false
local flySpeed = 50
local bodyVelocity, bodyGyro

PlayerTab:CreateSlider({
    Name = "Fly Speed",
    Range = {10, 200},
    Increment = 5,
    CurrentValue = 50,
    Suffix = "speed",
    Callback = function(v) flySpeed = v end,
})
PlayerTab:CreateToggle({
    Name = "Fly",
    CurrentValue = false,
    Callback = function(state)
        flyEnabled = state
        if not state then
            if bodyVelocity then bodyVelocity:Destroy() end
            if bodyGyro then bodyGyro:Destroy() end
        end
    end,
})

RunService.Heartbeat:Connect(function()
    if flyEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local hrp = LocalPlayer.Character.HumanoidRootPart
        if not bodyVelocity then
            bodyVelocity = Instance.new("BodyVelocity")
            bodyVelocity.MaxForce = Vector3.new(1e5, 1e5, 1e5)
            bodyVelocity.Parent = hrp
        end
        if not bodyGyro then
            bodyGyro = Instance.new("BodyGyro")
            bodyGyro.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
            bodyGyro.Parent = hrp
        end
        local camCF = workspace.CurrentCamera.CFrame
        local moveDir = Vector3.new()
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + camCF.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - camCF.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - camCF.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + camCF.RightVector end
        bodyVelocity.Velocity = moveDir.Unit * flySpeed
        bodyGyro.CFrame = camCF
    end
end)

-- Noclip
local noclip = false
PlayerTab:CreateToggle({
    Name = "Noclip",
    CurrentValue = false,
    Callback = function(state) noclip = state end,
})
RunService.Stepped:Connect(function()
    if noclip and LocalPlayer.Character then
        for _, part in ipairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then part.CanCollide = false end
        end
    end
end)

-- Teleport to Player
local selectedPlayer = nil
local dropdown = PlayerTab:CreateDropdown({
    Name = "Select Player",
    Options = {},
    CurrentOption = "",
    Callback = function(opt) selectedPlayer = opt end,
})
PlayerTab:CreateButton({
    Name = "Teleport to Player",
    Callback = function()
        if selectedPlayer then
            local target = Players:FindFirstChild(selectedPlayer)
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character:MoveTo(target.Character.HumanoidRootPart.Position)
            end
        end
    end,
})

local function updatePlayerList()
    local list = {}
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then table.insert(list, plr.Name) end
    end
    dropdown:Refresh(list, true)
end
updatePlayerList()
Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)

-------------------------------------------------
-- TELEPORT TAB
-------------------------------------------------
local teleportPositions = {
    ["POS 1"] = Vector3.new(5, 12, -404),
    ["POS 2"] = Vector3.new(-184, 128, 408),
    ["POS 3"] = Vector3.new(-166, 229, 652),
    ["POS 4"] = Vector3.new(-38, 406, 616),
    ["POS 5"] = Vector3.new(130, 651, 614),
    ["POS 6"] = Vector3.new(-247, 666, 735),
    ["POS 7"] = Vector3.new(-685, 641, 868),
    ["POS 8"] = Vector3.new(-658, 688, 1458),
    ["POS 9"] = Vector3.new(-507, 903, 1868),
    ["POS 10"] = Vector3.new(59, 950, 2089),
    ["POS 11"] = Vector3.new(52, 981, 2450),
    ["POS 12"] = Vector3.new(72, 1097, 2456),
    ["POS 13"] = Vector3.new(264, 1270, 2038),
    ["POS 14"] = Vector3.new(-419, 1302, 2395),
    ["POS 15"] = Vector3.new(-773, 1314, 2665),
    ["POS 16"] = Vector3.new(-837, 1475, 2626),
    ["POS 17"] = Vector3.new(-469, 1465, 2769),
    ["POS 18"] = Vector3.new(-468, 1537, 2837),
    ["POS 19"] = Vector3.new(-386, 1640, 2795),
    ["POS 20"] = Vector3.new(-208, 1666, 2749),
    ["POS 21"] = Vector3.new(-233, 1742, 2792),
    ["POS 22"] = Vector3.new(-423, 1740, 2799),
    ["POS 23"] = Vector3.new(-424, 1713, 3421),
    ["POS 24"] = Vector3.new(71, 1719, 3428),
    ["POS 25"] = Vector3.new(436, 1720, 3431),
    ["POS 26"] = Vector3.new(625, 1799, 3433),
    ["PUNCAK"] = Vector3.new(781, 2163, 3921)
}

local posDropdown = TeleportTab:CreateDropdown({
    Name = "Select Position",
    Options = {},
    CurrentOption = "",
    Callback = function(opt)
        if teleportPositions[opt] and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character:MoveTo(teleportPositions[opt])
        end
    end,
})
posDropdown:Refresh((function() local t={} for k in pairs(teleportPositions) do table.insert(t,k) end return t end)(), true)

-------------------------------------------------
-- SERVER TAB
-------------------------------------------------
ServerTab:CreateButton({
    Name = "Rejoin Server",
    Callback = function()
        TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
    end,
})
ServerTab:CreateButton({
    Name = "Hop Server",
    Callback = function()
        local servers = HttpService:JSONDecode(game:HttpGet(
            "https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
        for _, server in pairs(servers.data) do
            if server.playing < server.maxPlayers then
                TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, LocalPlayer)
                break
            end
        end
    end,
})

-------------------------------------------------
-- TROLL TAB
-------------------------------------------------
local auraEnabled = false
local auraRadius = 15
local flingPower = 200

TrollTab:CreateSlider({
    Name = "Aura Fling Radius",
    Range = {5, 200},
    Increment = 5,
    CurrentValue = 15,
    Suffix = "studs",
    Callback = function(v) auraRadius = v end,
})
TrollTab:CreateSlider({
    Name = "Aura Fling Power",
    Range = {50, 1000},
    Increment = 50,
    CurrentValue = 200,
    Suffix = "force",
    Callback = function(v) flingPower = v end,
})
TrollTab:CreateToggle({
    Name = "Aura Fling",
    CurrentValue = false,
    Callback = function(v) auraEnabled = v end,
})

RunService.Heartbeat:Connect(function()
    if auraEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local root = LocalPlayer.Character.HumanoidRootPart
        for _, plr in ipairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                local tr = plr.Character.HumanoidRootPart
                local dist = (tr.Position - root.Position).Magnitude
                if dist <= auraRadius then
                    local dir = (tr.Position - root.Position).Unit
                    root.Velocity = dir * flingPower
                    root.RotVelocity = Vector3.new(0, flingPower/10, 0)
                end
            end
        end
    end
end)
